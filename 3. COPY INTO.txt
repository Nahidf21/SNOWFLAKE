USE DATABASE EXERCISE_DB;
-- CREATE A SCHEMA 
CREATE OR REPLACE SCHEMA EXERCISE_DB.DATAS;

-- DROP SCHEMA EXERCISE_DB.EXTERNAL;

-- CREATE A SCHEMA FOR EXTERNAL DATABASE 
CREATE OR REPLACE SCHEMA EXERCISE_DB.EXTERNAL1;

-- CREATE AN AWS STAGE IN THE EXERCIESE_DB 
CREATE OR REPLACE STAGE EXERCISE_DB.EXTERNAL1.AWS_STAGE
    url='s3://snowflake-assignments-mc/loadingdata/';

-- CHECK THE WAS STAGE LIST 
LIST @AWS_STAGE;

-- NOW WE WILL CREATE A TABLE IN THE DATAS SCHEMA 

CREATE OR REPLACE TABLE EXERCISE_DB.DATAS.CUSTOMERS
(
    ID INT,
    FIRST_NAME VARCHAR,
    LAST_NAME VARCHAR,
    EMAIL VARCHAR,
    AGE INT,
    CITY VARCHAR
);

-- CHECK THE TABLE DATA
SELECT * FROM EXERCISE_DB.DATAS.CUSTOMERS;

-- COPY INTO ( EXTERNAL DATA TO INTERNAL DATA)    
COPY INTO EXERCISE_DB.DATAS.CUSTOMERS 
    FROM @EXERCISE_DB.EXTERNAL1.AWS_STAGE
    FILE_FORMAT = (TYPE = CSV, FIELD_DELIMITER = ';', skip_header=1);  

-- FINALLY WE CAN SEE OUR DATA IN OUR INTERNAL TABLE. THE TOTAL NUMBER OF ROW IS 1600.
SELECT COUNT(*)FROM EXERCISE_DB.DATAS.CUSTOMERS;