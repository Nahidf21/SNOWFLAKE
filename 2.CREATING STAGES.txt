-- DATABASE TO MANAGE STAGE OBJECTS, FILE FORMATS ETC
CREATE OR REPLACE DATABASE MANAGE_DB;
CREATE OR REPLACE SCHEMA EXTERNAL_STAGES;

-- CREATING EXTERNAL STAGE

CREATE OR REPLACE STAGE MANAGE_DB.EXTERNAL_STAGES.AWS_STAGE
    URL = 'S3://BUCKETSNOWFLAKES3'
    CREDENTIALS = (AWS_KEY_ID = 'ABCD_DUMMY_ID' aws_SECReT_KEY = '1234abcd-key');

-- DESCRIPTION OF EXTERNAL STAGE
DESC STAGE MANAGE_DB.EXTERNAL_STAGES.AWS_STAGE;

-- ALTER EXTERNAL STAGE 
ALTER stage AWS_STAGE
    SET CREDENTIALS = ( AWS_KEY_ID = 'XYZ_DUMMY_ID' AWS_SECRET_KEY = '98xyz');


-- PUBLICLY ACCESSIBLE STAGING AREA 
CREATE OR REPLACE STAGE MANAGE_DB.EXTERNAL_STAGES.AWS_STAGE
    URL = 'S3://BUCKETSNOWFLAKES3';

-- LIST FILES IN STAGE
LIST @AWS_STAGE;